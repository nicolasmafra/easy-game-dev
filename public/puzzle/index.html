<body></body>
<script>

let canvas = document.createElement('canvas');
canvas.width = window.innerWidth - 20;
canvas.height = window.innerHeight - 20;
document.body.appendChild(canvas);

let ctx = canvas.getContext('2d');
ctx.font = '20px sans serif';
ctx.textAlign = 'center';
ctx.textBaseline = 'middle';

const gridSize = 40;
const cellSize = gridSize - 2;
const offset = gridSize;

let state = [0,1,2,3,4,5,6,7,8].sort(() => Math.random() - 0.5);

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    state.forEach((v, i) => {
        if (v != 0) {
            let col = i % 3;
            let row = (i - col) / 3;
            let x = offset + col * gridSize;
            let y = offset + row * gridSize;
            ctx.fillStyle = 'gray';
            ctx.fillRect(x - cellSize/2, y - cellSize/2, cellSize, cellSize);
            ctx.fillStyle = 'black';
            ctx.fillText(v, x, y);
        }
    });
}

draw();

document.addEventListener('keydown', (e) => {
    let i = state.indexOf(0);
    let col = i % 3;
    let row = (i - col) / 3;
    switch (e.code) {
        case 'ArrowUp':
            if (row < 2) swap(i, i + 3);
            break;
        case 'ArrowDown':
            if (row > 0) swap(i, i - 3);
            break;
        case 'ArrowLeft':
            if (col < 2) swap(i, i + 1);
            break;
        case 'ArrowRight':
            if (col > 0) swap(i, i - 1);
            break;
    }
    draw();
});

function swap(i, j) {
    let temp = state[i];
    state[i] = state[j];
    state[j] = temp;
}
</script>
